(function(e,c){var b={photoWidth:500,photoHeight:456,thumbnailWidth:74,thumbnailHeight:74,thumbnailCount:999,thumbnailAfter:1,activeIndex:1,refreshAd:0,refreshCount:3,showThumbnails:0,showName:1,showDescription:1,showControls:1,controlsAfter:1,showStatus:1,toggleThumbnails:1,showCaptions:1,captionsAfter:1,ui:{slides:"> .photos > li",galleryName:"> h2",galleryDescription:"> .description",anchors:"> .photos > li > a",thumbnails:"> .thumbnails"},data:{galleryPhotos:[]},namespace:"aol-photo-gallery"},f=2,a=9,d="photo";e.getDynamicImageSrc=function(k,m,n,g,i){var o,h,j,l;if(typeof g==="object"){i=g}e.extend(o={},{action:"resize",format:null,quality:60},i);h=m+"x"+n;j=(g&&typeof g!=="object")?"thumbnail":o.action;l="/quality/"+o.quality;if(o.crop){h+="+"+(o.crop.x||0)+"+"+(o.crop.y||0)}if(o.format){l+="/format/"+o.format}return"http://o.aolcdn.com/dims-global/dims3/GLOB/"+j+"/"+h+l+"/"+k};e.aolPhotoGallery=function(k,G){if(G){var j=e.extend(true,{},b,k),C=e(G),n=C.clone(),t=j.ui,L=j.data,I=L.galleryPhotos,r=j.namespace,A=j.activeIndex-1,m,E=j.photoWidth,y=j.photoHeight,q=j.thumbnailWidth,h=j.thumbnailHeight,s={},i,D,l,o,w,K,H,F,J,u,g,v,B={init:function(){var N=t.$galleryName=n.find(t.galleryName),M=t.$galleryDescription=n.find(t.galleryDescription);L.galleryName=N.text();L.galleryDescription=M.html();i=t.$anchors=n.find(t.anchors);D=t.$slides=n.find(t.slides);l=t.$slideContainer=D.parent();l.css({height:y+"px",width:E+"px"});D.css({width:E+"px",height:y+"px",lineHeight:y+"px"});m=i.length;if(A>=m){A=m-1}i.each(function(R){var Q=this,P=e(Q),O=P.text(),T=P.attr("title"),S=P.attr("data-photo-src");I.push({photoName:O,photoDescription:T,photoSrc:S})});if(j.customClass){n.addClass(j.customClass)}B.buildGallery();if(!j.showName){N.hide()}if(!j.showDescription){M.hide()}if(j.showCaptions){B.buildCaptions()}B.buildStatus();if(j.showControls){B.buildControls()}if(j.showThumbnails||j.toggleThumbnails){B.buildThumbnails()}if(j.sponsorImage){B.buildSponsor()}C.replaceWith(n)},preloadPhoto:function(N){if(!s[N]){var M=new Image();M.src=e.getDynamicImageSrc(I[N].photoSrc,E,y);s[N]=1}},buildGallery:function(){D.css({opacity:0});D.eq(A).css({zIndex:1,opacity:1,visibility:"visible"});D.css("background",function(N){var M=I[N],O=M.photoSrc,P=e.getDynamicImageSrc(O,E,y);this.style.background="url("+P+") no-repeat center center"});i.remove();l.wrap('<div class="gallery"></div>');K=t.$gallery=l.parent();if(j.showThumbnails&&j.toggleThumbnails){setTimeout(function(){l.css({position:"absolute",left:-K.width()})},0)}B.bindGallery()},bindGallery:function(){n.delegate(".photos > li","click."+r,function(){e(this).trigger("next-click."+r)});n.delegate(".photos > li","mouseover."+r,function(){e(this).trigger("next-mouseover."+r)});n.bind("thumbnail-mouseover."+r,function(N,O){var M=O.index;B.preloadPhoto(M)});n.bind("back-mouseover."+r,function(N,O){var M=A===0?m-1:A-1;B.preloadPhoto(M)});n.bind("next-mouseover."+r,function(N,O){var M=A===m-1?0:A+1;B.preloadPhoto(M)});n.bind("status-update."+r,function(R,S){var T=S.oldIndex,N=S.activeIndex,Q=D.eq(T),O=D.eq(N),P=N===0?m-1:N-1,M=N===m-1?0:N+1;Q.css({zIndex:0}).animate({opacity:0},250);O.css({visibility:"visible",zIndex:1}).animate({opacity:1},250);B.preloadPhoto(P);B.preloadPhoto(M)});if(j.toggleThumbnails){n.bind("show-thumbnails."+r,function(){l.css("position","relative").animate({left:-K.width()},250)});n.bind("thumbnail-click."+r,function(M,N){l.css({position:"relative"}).animate({left:0},250);D.eq(A).css({opacity:0});D.eq(N.index).css({opacity:1})});n.bind("thumbnail-first-click."+r,function(){l.css({position:"relative"})})}},buildCaptions:function(){var P=0,M=t.$anchors.length,N=['<ul class="captions">'],O;for(;P<M;P++){O=I[P];N.push('<li data-index="'+P+'"><h3>'+O.photoName+"</h3>"+O.photoDescription+"</li>")}N.push("</ul>");o=e(N.join(""));if(j.captionsAfter){K.after(o)}else{K.prepend(o)}o=t.$captions=o.find("li");o.eq(A).css({zIndex:1,visibility:"visible"});w=t.$captionContainer=o.parent();setTimeout(function(){w.height(o.eq(A).height())},0);B.bindCaptions();if(j.showThumbnails&&j.toggleThumbnails){w.hide()}},bindCaptions:function(){n.bind("status-update."+r,function(O,P){var R=P.oldIndex,N=P.activeIndex,M=o.eq(R),Q=o.eq(N);Q.css({visibility:"visible",opacity:0,zIndex:1}).animate({opacity:1},250);M.css({zIndex:0}).animate({opacity:0},250);w.animate({height:Q.height()},250)});if(j.toggleThumbnails){n.bind("show-thumbnails."+r,function(){w.css("opacity",0)});n.bind("thumbnail-click."+r,function(){o.eq(A).css("opacity",0);w.css({display:"block",visibility:"visible",opacity:1})})}},buildStatus:function(){var M='<div class="status">'+(A+1)+" of "+m+"</div>";H=t.$status=e(M);K.after(H);if(!j.showStatus){H.hide()}else{if(j.showThumbnails&&j.toggleThumbnails){H.hide()}}B.bindStatus()},bindStatus:function(){n.bind("thumbnail-click."+r,function(M,N){var O=A;A=N.index;if(O!==A){H.html((A+1)+" of "+m).trigger("status-update."+r,[{oldIndex:O,activeIndex:A}])}});n.bind("back-click."+r,function(M,N){var O=A;A=A===0?m-1:A-1;H.html((A+1)+" of "+m).trigger("status-update."+r,[{oldIndex:O,activeIndex:A}])});n.bind("next-click."+r,function(){var M=A;A=A===m-1?0:A+1;H.html((A+1)+" of "+m).trigger("status-update."+r,[{oldIndex:M,activeIndex:A}])});if(j.toggleThumbnails){n.bind("show-thumbnails."+r,function(){H.css("visibility","hidden")});n.bind("thumbnail-click."+r,function(){H.css({display:"block",visibility:"visible"})})}},buildControls:function(){F=t.$controls=e('<ul class="controls"><li class="back"><b>Back</b></li><li class="next"><b>Next</b></li></ul>');if(j.controlsAfter){K.after(F)}else{K.before(F)}B.bindControls();if(j.showThumbnails&&j.toggleThumbnails){F.hide()}},bindControls:function(){n.delegate(".controls > .back","click."+r,function(){e(this).trigger("back-click."+r)});n.delegate(".controls > .next","click."+r,function(){e(this).trigger("next-click."+r)});n.delegate(".controls > .back","mouseover."+r,function(){e(this).trigger("back-mouseover."+r)});n.delegate(".controls > .next","mouseover."+r,function(){e(this).trigger("next-mouseover."+r)});if(j.toggleThumbnails){n.bind("show-thumbnails."+r,function(){F.css("visibility","hidden")});n.bind("thumbnail-click."+r,function(){F.css({display:"block",visibility:"visible"})})}},buildThumbnails:function(){var O=0,N=t.$anchors.length,M=j.thumbnailCount,P=['<ul class="thumbnails">'];for(;O<N;O++){P.push('<li style="background: url('+e.getDynamicImageSrc(I[O].photoSrc,q,h,1)+") no-repeat center center; width: "+q+"px; height: "+h+"px; display: "+((O>=M)?"none":"block")+'; opacity: .7;" data-index="'+O+'"></li>')}P.push("</ul>");J=e(P.join(""));if(j.thumbnailAfter){n.append(J)}else{K.prepend(J)}u=t.$thumbnails=J.find("li");u.eq(A).css({opacity:1});B.bindThumbnails();if(j.toggleThumbnails){setTimeout(function(){if(j.showThumbnails){n.data("thumbnail-view-height."+r,n.height())}else{n.data("thumbnail-view-height."+r,n.height()-y)}if(j.showThumbnails){J.css({width:n.width(),left:0,top:J.position().top,height:J.height()})}else{J.css({position:"absolute",left:K.width(),top:l.position().top,width:K.width(),height:J.height()})}},0);B.buildShowThumbnails()}},bindThumbnails:function(){n.delegate(".thumbnails > li","mouseover."+r,function(){var O=this,M=e(O),N=+M.attr("data-index");M.trigger("thumbnail-mouseover."+r,[{index:N}]);if(N!==A){M.stop().fadeTo(250,1)}});n.delegate(".thumbnails > li","mouseout."+r,function(){var O=this,M=e(O),N=+M.attr("data-index");M.trigger("thumbnail-mouseout."+r,[{index:N}]);if(N!==A){M.stop().fadeTo(250,0.7)}});n.delegate(".thumbnails > li","click."+r,function(){var O=this,M=e(O),N=+M.attr("data-index");M.trigger("thumbnail-click."+r,[{index:N}])});n.bind("status-update."+r,function(N,O){var P=O.oldIndex,M=O.activeIndex;u.eq(P).removeClass("active").fadeTo(250,0.7);u.eq(M).addClass("active").fadeTo(250,1)});if(j.toggleThumbnails){n.bind("show-thumbnails."+r,function(){n.height(n.data("thumbnail-view-height."+r));J.css({top:K.position().top,left:K.width()});J.animate({left:0-parseInt(J.css("marginLeft"),10)},250)});n.bind("thumbnail-click."+r,function(){J.css({position:"absolute"}).animate({left:K.width()},250).queue(function(M){n.height("auto");M()})})}},buildShowThumbnails:function(){var M='<div class="show-thumbnails"><b>Show Thumbnails</b></div>';g=t.$showThumbnails=e(M);if(j.showThumbnails){g.css("visibility","hidden")}else{g.css("visibility","visible")}K.before(g);B.bindShowThumbnails()},bindShowThumbnails:function(){n.delegate(".show-thumbnails","click."+r,function(){n.trigger("show-thumbnails."+r)});n.bind("show-thumbnails."+r,function(){t.$showThumbnails.css("visibility","hidden")});n.bind("thumbnail-click."+r,function(){t.$showThumbnails.css("visibility","visible")})},buildSponsor:function(){var M=['<a class="sponsor" style="background: url(',j.sponsorImage,') no-repeat center center" href="',j.sponsorUrl,'">',j.sponsorName,"</a>"].join("");v=t.$sponsor=e(M);n.prepend(v)}},p=function(){function M(){}var P=j.refreshAd.split(),N=0,O=j.refreshCount;if(O>a){O=a}if(O<f){O=f}n.bind("status-update."+r,function(){N++;if(N===O){M();N=0}})},x=function(){var N=new RegExp("#"+d+"-[0-9]+"),M=N.exec(c.href);n.bind("status-update."+r,function(Q,R){var O=R.activeIndex+1,P=c.href,S="#"+d+"-"+O;if(N.test(P)){c.href=P.replace(N,S)}else{c.href=P+S}});if(M){A=M[0].replace("#"+d+"-","")-1}},z=function(){if(j.refreshAd){p(j)}x()};z();B.init()}else{e.extend(true,b,k)}};e.fn.aolPhotoGallery=function(g){return this.each(function(){e.aolPhotoGallery(g,this)})}})(jQuery,location);